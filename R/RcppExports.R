# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

cpp_compute_pair_ext <- function(CONSTRMAT, CONSTRLOGSD, LLC, C_VEC, THETA, CORRFLAG, NTHR, NLOAD, NCORR, NVAR, K, L, PAIRS_TABLE, SILENTFLAG, GRADFLAG, OPTION = 0L) {
    .Call(`_plFA_cpp_compute_pair_ext`, CONSTRMAT, CONSTRLOGSD, LLC, C_VEC, THETA, CORRFLAG, NTHR, NLOAD, NCORR, NVAR, K, L, PAIRS_TABLE, SILENTFLAG, GRADFLAG, OPTION)
}

cpp_loadings_theta2vec <- function(THETA, NTHR, NLOAD) {
    .Call(`_plFA_cpp_loadings_theta2vec`, THETA, NTHR, NLOAD)
}

cpp_loadings_theta2mat <- function(THETA, CONSTRMAT, LLC, NTHR, NLOAD) {
    .Call(`_plFA_cpp_loadings_theta2mat`, THETA, CONSTRMAT, LLC, NTHR, NLOAD)
}

cpp_loadings_mat2vec <- function(LOADINGS, CONSTRMAT, NLOAD) {
    .Call(`_plFA_cpp_loadings_mat2vec`, LOADINGS, CONSTRMAT, NLOAD)
}

cpp_latvar_vec2cmat <- function(VEC, NCORR, Q) {
    .Call(`_plFA_cpp_latvar_vec2cmat`, VEC, NCORR, Q)
}

cpp_latvar_vec2dmat <- function(VEC, CONSTRLOGSD, NCORR, NVAR, Q) {
    .Call(`_plFA_cpp_latvar_vec2dmat`, VEC, CONSTRLOGSD, NCORR, NVAR, Q)
}

cpp_latvar_theta2cmat <- function(THETA, NTHR, NLOAD, NCORR, NVAR, Q) {
    .Call(`_plFA_cpp_latvar_theta2cmat`, THETA, NTHR, NLOAD, NCORR, NVAR, Q)
}

cpp_latvar_theta2dmat <- function(THETA, CONSTRLOGSD, NTHR, NLOAD, NCORR, NVAR, Q) {
    .Call(`_plFA_cpp_latvar_theta2dmat`, THETA, CONSTRLOGSD, NTHR, NLOAD, NCORR, NVAR, Q)
}

cpp_latvar_theta2mat <- function(THETA, CONSTRLOGSD, NTHR, NLOAD, NCORR, NVAR, Q) {
    .Call(`_plFA_cpp_latvar_theta2mat`, THETA, CONSTRLOGSD, NTHR, NLOAD, NCORR, NVAR, Q)
}

cpp_latvar_mat2vec <- function(S, CONSTRLOGSD, NCORR, NVAR) {
    .Call(`_plFA_cpp_latvar_mat2vec`, S, CONSTRLOGSD, NCORR, NVAR)
}

cpp_latvar_mat2cmat <- function(S) {
    .Call(`_plFA_cpp_latvar_mat2cmat`, S)
}

cpp_sa_proj <- function(THETA, CONSTRMAT, CONSTRLOGSD, LLC, C_VEC, CORRFLAG, NTHR, NLOAD, NCORR, NVAR) {
    .Call(`_plFA_cpp_sa_proj`, THETA, CONSTRMAT, CONSTRLOGSD, LLC, C_VEC, CORRFLAG, NTHR, NLOAD, NCORR, NVAR)
}

#' Compute pairwise frequencies
#'
#' @param Y Integer matrix of dimension \eqn{n*p}, where \eqn{n} is the sample size
#' and \eqn{p} is the number of items considered. Categories must be coded starting from zero.
#' For example, an item with three categories can only accept values contained in
#' \eqn{\{0, 1, 2\}}.
#' @param C_VEC Integer vector indicating how many possible categories are associated to
#' each item in 'Y'.
#'
#' @return
#' It returns a 5-rows matrix with each combination of items and categories as columns.
#' Row0: item k, Row1: item l, Row2; category item k, Row3: category item l, Row4: freq
#' It is computed just once, before the optimization of the complete pairwise
#'
#' @export
pairs_freq <- function(Y, C_VEC) {
    .Call(`_plFA_pairs_freq`, Y, C_VEC)
}

#' Full pairwise iteration
#'
#' @description
#' Evaluate negative log pairwise likelihood or gradient of the complete pool of pairs.
#' Used by external optimisers. Multithreading options via `RcppParallel`.
#'
#' @param N Number of observations
#' @param C_VEC Vector containing the number of categories for each item
#' @param CONSTRMAT \eqn{p*q}-dimensional matrix. Elements set to `NA` refers to free loading parameters. Elements set to numerical values denote fixed values constraints.
#' @param CONSTRLOGSD \eqn{q}-dimensional vector. Elements set to `NA` refers to free latent log standard deviations parameters. Elements set to numerical values denote fixed values constraints.
#' @param LLC Linear loadings constraints. Expects a list of constraints. See [fit_plFA] documentation.
#' @param THETA Parameter vector
#' @param FREQ Frequency table
#' @param CORRFLAG TRUE to estimate latent correlations. 0 for orthogonal latent factors.
#' @param NTHR Number of thresholds parameters.
#' @param NLOAD Number of free loadings parameters
#' @param NCORR Number of free latent correlations parameters.
#' @param NVAR Number of free latent variance parameters.
#' @param GRFLAG 0 to only compute the likelihood. 1 to also compute the gradient.
#' @param SILENTFLAG optional for verbose output
#'
cpp_multiThread_completePairwise2 <- function(N, C_VEC, CONSTRMAT, CONSTRLOGSD, LLC, THETA, FREQ, CORRFLAG, NTHR, NLOAD, NCORR, NVAR, GRFLAG = 0L, SILENTFLAG = 1L) {
    .Call(`_plFA_cpp_multiThread_completePairwise2`, N, C_VEC, CONSTRMAT, CONSTRLOGSD, LLC, THETA, FREQ, CORRFLAG, NTHR, NLOAD, NCORR, NVAR, GRFLAG, SILENTFLAG)
}

#' Full pairwise iteration
#'
#' @description
#' Evaluate negative log pairwise likelihood or gradient of the complete pool of pairs.
#' Used by external optimisers. Multithreading options via `RcppParallel`.
#'
#' @param N Number of observations
#' @param C_VEC Vector containing the number of categories for each item
#' @param CONSTRMAT \eqn{p*q}-dimensional matrix. Elements set to `NA` refers to free loading parameters. Elements set to numerical values denote fixed values constraints.
#' @param CONSTRLOGSD \eqn{q}-dimensional vector. Elements set to `NA` refers to free latent log standard deviations parameters. Elements set to numerical values denote fixed values constraints.
#' @param LLC Linear loadings constraints. Expects a list of constraints. See [fit_plFA] documentation.
#' @param THETA Parameter vector
#' @param FREQ Frequency table
#' @param CORRFLAG TRUE to estimate latent correlations. 0 for orthogonal latent factors.
#' @param NTHR Number of thresholds parameters.
#' @param NLOAD Number of free loadings parameters
#' @param NCORR Number of free latent correlations parameters.
#' @param NVAR Number of free latent variance parameters.
#' @param GRFLAG 0 to only compute the likelihood. 1 to also compute the gradient.
#' @param SILENTFLAG optional for verbose output
#'
cpp_multiThread_completePairwise <- function(N, C_VEC, CONSTRMAT, CONSTRLOGSD, LLC, THETA, FREQ, CORRFLAG, NTHR, NLOAD, NCORR, NVAR, GRFLAG = 0L, SILENTFLAG = 1L) {
    .Call(`_plFA_cpp_multiThread_completePairwise`, N, C_VEC, CONSTRMAT, CONSTRLOGSD, LLC, THETA, FREQ, CORRFLAG, NTHR, NLOAD, NCORR, NVAR, GRFLAG, SILENTFLAG)
}

cpp_plSA2 <- function(FREQ, VALFREQ, N, C_VEC, CONSTRMAT, CONSTRLOGSD, LLC, THETA_INIT, DIH, NTHR, NLOAD, NCORR, NVAR, PAIRS_PER_ITERATION, STEP0, STEP1, STEP2, STEP3, BURNE, MAXE, EPOCHS_PER_CHECK, MAX_TOL_COUNTER, TOL_BURN, TOL_END, CHECK_TOL, SEED, VERBOSE, VERBOSE_ITER = FALSE) {
    .Call(`_plFA_cpp_plSA2`, FREQ, VALFREQ, N, C_VEC, CONSTRMAT, CONSTRLOGSD, LLC, THETA_INIT, DIH, NTHR, NLOAD, NCORR, NVAR, PAIRS_PER_ITERATION, STEP0, STEP1, STEP2, STEP3, BURNE, MAXE, EPOCHS_PER_CHECK, MAX_TOL_COUNTER, TOL_BURN, TOL_END, CHECK_TOL, SEED, VERBOSE, VERBOSE_ITER)
}

#' Estimate of H
#'
#' @description
#' Compute a sample estimate of the expected negative Hessian by taking
#' advantage of the second Bartlett's identity at the single pair level
#'
#' @param A Constraint matrix. Loadings free to be estimated are identified by a 1.
#' @param CONSTRLOGSD \eqn{q}-dimensional vector. Elements set to `NA` refers to free latent log standard deviations parameters. Elements set to numerical values denote fixed values constraints.
#' @param LLC Linear loadings constraints. Expects a list of constraints. See [fit_plFA] documentation.
#' @param C_VEC Vector containing the number of categories for each item
#' @param THETA Parameter vector
#' @param FREQ output from [pairs_freq()]
#' @param N sample size
#' @param CORRFLAG 1 to estimate latent correlations. 0 for orthogonal latent factors.
#' @param NTHR Number of thresholds parameters.
#' @param NLOAD Number of free loadings parameters
#' @param NCORR Number of free latent correlations parameters.
#' @param NVAR Number of free latent variance parameters.
#'
estimate_H <- function(C_VEC, A, CONSTRLOGSD, LLC, THETA, FREQ, N, CORRFLAG, NTHR, NLOAD, NCORR, NVAR) {
    .Call(`_plFA_estimate_H`, C_VEC, A, CONSTRLOGSD, LLC, THETA, FREQ, N, CORRFLAG, NTHR, NLOAD, NCORR, NVAR)
}

#' Estimate of J
#'
#' @description
#' Compute a sample estimate of the variability matrix via the sample average outer product
#' of the composite score
#'
#' @param A Constraint matrix. Loadings free to be estimated are identified by a 1.
#' @param C_VEC Vector containing the number of categories for each item
#' @param THETA Parameter vector
#' @param CONSTRLOGSD \eqn{q}-dimensional vector. Elements set to `NA` refers to free latent log standard deviations parameters. Elements set to numerical values denote fixed values constraints.
#' @param LLC Linear loadings constraints. Expects a list of constraints. See [fit_plFA] documentation.
#' @param CORRFLAG 1 to estimate latent correlations. 0 for orthogonal latent factors.
#' @param Y data matrix
#' @param NTHR Number of thresholds parameters.
#' @param NLOAD Number of free loadings parameters
#' @param NCORR Number of free latent correlations parameters.
#' @param NVAR Number of free latent variance parameters.
#'
estimate_J <- function(Y, C_VEC, A, CONSTRLOGSD, LLC, THETA, CORRFLAG, NTHR, NLOAD, NCORR, NVAR) {
    .Call(`_plFA_estimate_J`, Y, C_VEC, A, CONSTRLOGSD, LLC, THETA, CORRFLAG, NTHR, NLOAD, NCORR, NVAR)
}

#' Estimate Diagonal of H
#'
#' @description
#' Compute a sample estimate of the expected negative Hessian by taking
#' advantage of the second Bartlett's identity at the single pair level
#'
#' @param A Constraint matrix. Loadings free to be estimated are identified by a 1.
#' @param CONSTRLOGSD \eqn{q}-dimensional vector. Elements set to `NA` refers to free latent log standard deviations parameters. Elements set to numerical values denote fixed values constraints.
#' @param LLC Linear loadings constraints. Expects a list of constraints. See [fit_plFA] documentation.
#' @param C_VEC Vector containing the number of categories for each item
#' @param THETA Parameter vector
#' @param FREQ output from [pairs_freq()]
#' @param N sample size
#' @param CORRFLAG 1 to estimate latent correlations. 0 for orthogonal latent factors.
#' @param NTHR Number of thresholds parameters.
#' @param NLOAD Number of free loadings parameters
#' @param NCORR Number of free latent correlations parameters.
#' @param NVAR Number of free latent variance parameters.
#'
cpp_DH <- function(C_VEC, A, CONSTRLOGSD, LLC, THETA, FREQ, N, CORRFLAG, NTHR, NLOAD, NCORR, NVAR) {
    .Call(`_plFA_cpp_DH`, C_VEC, A, CONSTRLOGSD, LLC, THETA, FREQ, N, CORRFLAG, NTHR, NLOAD, NCORR, NVAR)
}

